# 交易所低延迟技术行业基准

> **数据来源**: Nasdaq官方产品页面（营销材料）、Deutsche Börse T7技术白皮书 (2025年3月)
> **更新日期**: 2026-01-28

---

## 一、Nasdaq Co-Location 托管服务

> 来源: [NasdaqTrader.com/CoLo](https://www.nasdaqtrader.com/TRADER.ASPX?ID=COLO)
> **文档性质**: 产品营销页面（非技术白皮书，延迟数据为商业宣传级别）

### 核心延迟指标

```
┌─────────────────────────────────────────────────────────────────────┐
│                    NASDAQ 托管环境延迟架构                           │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│   客户服务器 ──────► Nasdaq交换机 ──────► 撮合引擎                   │
│       │                   │                   │                     │
│       │◄──────────────────┼───────────────────┤                     │
│       │         往返延迟 < 50µs               │                     │
│                                                                     │
│   ┌─────────────────────────────────────────────────────────────┐   │
│   │  关键指标                                                    │   │
│   │  • 订单确认往返延迟 (Order-to-Ack):     < 50 µs            │   │
│   │  • 行情更新往返延迟 (Order-to-Tick):    < 50 µs            │   │
│   │  • 托管延迟改善:                         2-5 µs             │   │
│   └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 连接选项与定价

> **注**: 价格来源于2016年官方价格表，可能已变动，请以最新官方报价为准

| 连接类型 | 带宽 | 一次性费用 (NRC) | 月费 (MRC) | 延迟特性 |
|----------|------|------------------|------------|----------|
| **10G Ultra** | 10 Gbps | $1,500 | $15,000 | 最低延迟 |
| **10G 标准** | 10 Gbps | $1,000 | $10,000 | 标准 |
| **40G** | 40 Gbps | $1,500 | $20,000 | 高带宽 |
| **1G Ultra** | 1 Gbps | $1,500 | $2,500 | 低成本低延迟 |

### 覆盖市场

```
┌──────────────────────────────────────────────────────────────┐
│                    Nasdaq 托管覆盖市场                        │
├──────────────────────────────────────────────────────────────┤
│  股票市场          期权市场           固定收益               │
│  ┌─────────┐      ┌─────────┐       ┌─────────┐             │
│  │ Nasdaq  │      │  NOM    │       │ eSpeed  │             │
│  │   BX    │      │  PHLX   │       │         │             │
│  │   PSX   │      │  ISE    │       └─────────┘             │
│  └─────────┘      │  GEMX   │                               │
│                   │  MRX    │                               │
│                   │BX Opts  │                               │
│                   └─────────┘                               │
│                                                              │
│  ★ 单一接入点覆盖所有市场，减少网络复杂度                    │
└──────────────────────────────────────────────────────────────┘
```

### 设施特点

| 特性 | 描述 |
|------|------|
| **位置** | Carteret, NJ 数据中心 |
| **电力** | 冗余电源 + 发电机备份 |
| **冷却** | 高效冷却系统 |
| **安全** | 火灾探测/灭火系统 |
| **互联** | 100+ 金融机构入驻 |

---

## 二、Nasdaq Express Connect 低延迟专线

> 来源: [Express Connect Factsheet (PDF)](https://www.nasdaqtrader.com/content/Productsservices/trading/CoLo/ExpressConnect_factsheet.pdf)
> **文档性质**: 产品事实表（营销材料，提供技术概述但无详细延迟分解）

### 技术架构

```
┌─────────────────────────────────────────────────────────────────────┐
│                    Express Connect 网络拓扑                          │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│   Nasdaq数据中心                              外部交易场所           │
│   (Carteret, NJ)                                                    │
│                                                                     │
│   ┌──────────┐      EoDWDM专线        ┌──────────────────┐         │
│   │ 客户机柜 │ ◄──────────────────────► │ NYSE (Mahwah)   │         │
│   │          │      100MB/1G/10G       │ CME (Aurora)    │         │
│   │ 暗光纤   │                         │ ICE (Chicago)   │         │
│   │ 连接     │      SLA保障延迟        │ CBOE            │         │
│   └──────────┘                         │ TMX (Toronto)   │         │
│                                        └──────────────────┘         │
│                                                                     │
│   Section 1        Section 2           Section 3                    │
│   客户基础设施 ──► EoDWDM低延迟环路 ──► 交易所内部网络              │
│                    (SLA覆盖范围)                                    │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 技术特点

| 特性 | 描述 |
|------|------|
| **技术** | EoDWDM (Ethernet over Dense Wavelength Division Multiplexing) |
| **延迟等级** | 仅次于暗光纤的最低延迟方案 |
| **带宽选项** | 100MB / 1G / 10G |
| **交付时间** | ~10个工作日 |
| **SLA** | 保障延迟，随技术升级持续改善 |

### 覆盖场所

```
┌─────────────────────────────────────────────────────────────────────┐
│                      Express Connect 覆盖范围                        │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  纽约/新泽西都会区                                                   │
│  ├── 755 Secaucus Road (BATS, Direct Edge, BOX, ISE)               │
│  ├── 275 Hartz Way (ICE POP)                                       │
│  ├── 165 Halsey Street (NYSE, NYSE Arca, NYSE Amex via SFTI)       │
│  ├── 111 Eighth Avenue, NY (NYSE via SFTI)                         │
│  └── 545 Washington Boulevard (Knight, HotSpot)                    │
│                                                                     │
│  芝加哥都会区                                                        │
│  ├── 350 East Cermak Road (CME, ICE)                               │
│  ├── 440 S. LaSalle Street (CBOE, CFE)                             │
│  └── 2905 Diehl Road, Aurora (CME)                                 │
│                                                                     │
│  加拿大                                                              │
│  ├── 3500 Steeles Avenue East, Markham (TMX, TSX)                  │
│  └── 45 Parliament Street, Toronto (Nasdaq CX)                     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 三、Deutsche Börse T7 交易系统延迟分析

> 来源: [Insights into Trading System Dynamics (PDF, 2025年3月)](https://www.eurex.com/resource/blob/48918/4f724c9415d2731cfb27295db6269c9c/data/presentation_insights-into-trading-system-dynamics_en.pdf)
> **文档性质**: 技术白皮书（详细的延迟路径分解、时间戳测量方法、硬件规格，技术深度高）

### 系统架构概览

```
┌─────────────────────────────────────────────────────────────────────┐
│                       T7 交易系统延迟路径                            │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  参与者          接入网络        网关           撮合引擎            │
│                                                                     │
│  ┌─────┐      ┌─────────┐    ┌────────┐    ┌──────────────┐        │
│  │     │ t_1 │ Access  │t_3a│   PS   │t_3n│              │        │
│  │ 客户 │────►│  Layer  │───►│Gateway │───►│   Matching   │        │
│  │ 系统 │     │ Switch  │    │        │    │    Engine    │        │
│  │     │◄────│         │◄───│        │◄───│              │        │
│  └─────┘ t_2 └─────────┘t_4a└────────┘ t_4└──────────────┘        │
│                                                                     │
│  时间戳测量点:                                                       │
│  • t_1/t_2: 参与者网络捕获                                          │
│  • t_3a: Access Layer入口 (White Rabbit同步, ±1ns精度)             │
│  • t_3n: PS Gateway网卡接收时间                                     │
│  • t_5/t_6: 撮合引擎读/写时间                                       │
│  • t_7: 订单簿维护开始时间                                          │
│  • t_9: EOBI市场数据发送时间                                        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

> **行业惯例**：交易所与厂商公布的「端到端」延迟，通常以 **Gateway 收到报文**（如 t_3a 或 t_3n）为起点，不包含参与者侧网络与最后一跳；这样口径一致、可比，且不受客户机房/线路差异影响。

### 核心延迟指标 (2025年2月13日实测数据)

```
┌─────────────────────────────────────────────────────────────────────┐
│                    T7 延迟分解 (Eurex期货, HF会话)                   │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  请求路径 (Request Path)                                            │
│  ┌──────────────────────────────────────────────────────────────┐   │
│  │ 网络入口 ──► PS Gateway ──► 撮合引擎入口 ──► 开始撮合        │   │
│  │   t_3a        t_3n           t_5              t_7            │   │
│  │    │           │              │                │             │   │
│  │    ├── ~1µs ──►├── ~10µs ────►├─── ~1µs ──────►│             │   │
│  │                                                              │   │
│  │  总计: 网卡到撮合引擎 ≈ 12µs (中位数, PS Gateway直连)        │   │
│  └──────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  响应路径 (Response Path)                                           │
│  ┌──────────────────────────────────────────────────────────────┐   │
│  │ 撮合完成 ──► EOBI发送 ──► ETI响应发送                        │   │
│  │   t_7          t_9           t_4                             │   │
│  │    │            │             │                              │   │
│  │    ├── ~2µs ───►├── ~1.5µs ──►│ (EOBI比ETI快1.5-7.5µs)      │   │
│  └──────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 接入方式延迟对比

- **PS Gateway**：Partition Specific Gateway（分区专用网关），单分区直连，延迟最低。
- **LF Gateway**：Low Frequency Gateway（低频网关），单会话可访问多分区，延迟略高。

| 网关类型 | 同侧线路 | 同侧分区 | t_3a→t_3n 延迟 | 适用场景 |
|----------|----------|----------|----------------|----------|
| **PS Gateway** | ✓ | ✓ | **~1 µs** | 最低延迟, 单分区 |
| **PS Gateway** | ✗ | ✓ | **~2 µs** | 跨侧连接 |
| **LF Gateway** | ✓ | ✓ | **~12 µs** | 多分区访问 |
| **LF Gateway** | ✓ | ✗ | **~13 µs** | 跨分区 |
| **LF Gateway** | ✗ | ✓ | **~13 µs** | 跨侧 |
| **LF Gateway** | ✗ | ✗ | **~14 µs** | 跨侧跨分区 |

> **注**: 2025年1月优化后，跨侧连接延迟从~45µs降至~1µs

### 参与者反应时间分布

```
┌─────────────────────────────────────────────────────────────────────┐
│              参与者反应时间分布 (t_9d → t_3a)                        │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  基础设施最小延迟: 2787 ns (由T7硬件决定)                           │
│                                                                     │
│  反应时间 (纳秒)                                                    │
│  2700 ─────┬─────────────────────────────────────────────────────   │
│            │ ████ 最快参与者 (~10家 < 2830ns)                       │
│  2800 ─────┼─████████                                               │
│            │ ████████████                                           │
│  2900 ─────┼─████████████████                                       │
│            │ ████████████████████                                   │
│  3000 ─────┼─████████████████████████                               │
│            │ ████████████████████████████                           │
│  3100 ─────┼─████████████████████████████████                       │
│            │                                                        │
│  3500+ ────┴─────────────────────────────────────────────────────   │
│                                                                     │
│  ★ 高度竞争: 约10家参与者反应时间 < 2830ns                          │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 市场数据延迟特性

| 数据类型 | 描述 | 相对ETI响应 | 可用性 |
|----------|------|-------------|--------|
| **EOBI** | 逐笔订单数据 | 快 **1.5-7.5 µs** | 仅10G连接 |
| **EMDI** | 价格档位聚合 | 略慢于EOBI | 所有连接 |
| **MDI** | 净价格档位聚合 | 最慢 | 所有连接 |

### 硬件与基础设施

| 组件 | 规格 |
|------|------|
| **CPU** | Intel Xeon Platinum 8462Y+ |
| **操作系统** | Red Hat Enterprise Linux 8.10 (计划升级9.0) |
| **订单入口交换机** | Cisco Nexus 3548-XL (Cut-through模式) |
| **市场数据交换机** | Cisco Nexus 3550-T |
| **线缆标准化** | ±0.35m (±1.75ns) 偏差 |
| **时间同步** | White Rabbit协议 (~1ns精度) |
| **网卡** | Solarflare EnterpriseOnload (内核旁路) |

---

## 四、行业对比总结

### 延迟指标对比

```
┌─────────────────────────────────────────────────────────────────────┐
│                    主要交易所延迟对比                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  延迟 (µs)                                                          │
│     │                                                               │
│  50 ┤ ████████████████████████████████████████ Nasdaq往返 (<50µs)  │
│     │                                          (营销宣传值)         │
│  40 ┤                                                               │
│     │                                                               │
│  30 ┤                                                               │
│     │                                                               │
│  20 ┤ ████████████████████ T7 LF Gateway往返 (~24µs)               │
│     │                      (技术白皮书实测值)                       │
│  12 ┤ ████████████ T7 PS Gateway单程 (~12µs)                       │
│     │                                                               │
│   2 ┤ ██ T7 网络层 (~2µs)                                          │
│     │                                                               │
│   0 ┴─────────────────────────────────────────────────────────────  │
│                                                                     │
│  注: Nasdaq数据为往返延迟(宣传), T7数据为单程延迟(实测), 不可直接对比│
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 关键差异

| 维度 | Nasdaq | Deutsche Börse T7 |
|------|--------|-------------------|
| **文档性质** | 产品营销页面 | 技术白皮书 (极详细) |
| **延迟指标** | 往返 <50µs (宣传值) | 单程 ~12µs (实测值, PS Gateway) |
| **时间戳精度** | 未公开 | 纳秒级 (White Rabbit, ±1ns) |
| **线缆标准化** | 未公开 | ±0.35m (±1.75ns) |
| **参与者反应时间** | 未公开 | 公开分布图 (~2787ns最小) |
| **硬件规格** | 未公开 | 详细公开 (CPU/OS/交换机/网卡) |

### 技术透明度评级

| 交易所 | 延迟数据 | 架构细节 | 时间戳服务 | 参与者分析 | 文档类型 |
|--------|----------|----------|------------|------------|----------|
| **Nasdaq** | ⭐⭐ | ⭐⭐ | ⭐ | ⭐ | 营销材料 |
| **Deutsche Börse T7** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 技术白皮书 |

---

## 五、对本项目的启示

### 延迟目标参考

> ⚠️ **重要说明**: 以下对比存在测量口径差异，不可直接比较
> - **交易所数据**: 端到端往返延迟，包含网络传输、网关处理、撮合、响应路径
> - **本项目数据**: 纯撮合引擎内部处理时间，不包含网络层、序列化、队列等待

| 指标 | 交易所端到端 | 本项目撮合引擎 | 说明 |
|------|-------------|----------------|------|
| **P50延迟** | ~50µs 往返 (Nasdaq托管宣传) | 0.49µs | 口径不同，不可直接对比 |
| **P99延迟** | ~50µs 往返 (Nasdaq宣传上限) | 0.72µs | 口径不同，不可直接对比 |
| **参考**: T7单程 | ~12µs (PS Gateway→撮合) | - | T7为单程，更接近可比口径 |

### 实际可比参考

如果本项目部署为完整系统（含网络层），预估端到端延迟：

| 组件 | 预估延迟 | 参考 |
|------|----------|------|
| 网络接收 + 解析 | 1-5 µs | 取决于协议栈 (kernel/DPDK) |
| 撮合引擎处理 | ~0.5 µs | 当前测量值 |
| 响应序列化 + 发送 | 1-5 µs | 取决于协议栈 |
| **预估端到端单程** | **3-11 µs** | 与T7 PS Gateway单程(~12µs)可比 |
| **预估端到端往返** | **6-22 µs** | 优于Nasdaq宣传的<50µs |

### 吞吐量对比

| 指标 | 行业参考 | 本项目 | 说明 |
|------|----------|--------|------|
| **单分区吞吐** | ~500K msg/s (T7文档提及) | 9.4M TPS | 本项目为理想条件下峰值 |

### 技术借鉴

1. **时间同步**: T7使用White Rabbit协议实现~1ns精度，可考虑PTP/PPS方案
2. **网络架构**: 分层交换机设计 (Access → Distribution → Core)
3. **线缆标准化**: 控制物理层延迟偏差在纳秒级
4. **内核旁路**: Solarflare Onload / DPDK 用户态协议栈
5. **Cut-through交换**: 减少交换机存储转发延迟

---

## 参考链接

| 资源 | 链接 | 文档类型 |
|------|------|----------|
| Nasdaq Co-Location | https://www.nasdaqtrader.com/TRADER.ASPX?ID=COLO | 产品营销页面 |
| Nasdaq Express Connect | https://www.nasdaqtrader.com/content/Productsservices/trading/CoLo/ExpressConnect_factsheet.pdf | 产品事实表 |
| Nasdaq 低延迟连接价格 | https://nasdaqtrader.com/content/Productsservices/trading/CoLo/LowLatencyFS.pdf | 官方价格表 (2016) |
| T7 延迟分析白皮书 | https://www.eurex.com/resource/blob/48918/4f724c9415d2731cfb27295db6269c9c/data/presentation_insights-into-trading-system-dynamics_en.pdf | 技术白皮书 |
| T7 高精度时间戳服务 | https://www.mds.deutsche-boerse.com/mds-en/analytics/high-precision-timestamps | 技术文档 |
| Deutsche Börse 时间服务 | https://www.deutsche-boerse.com/dbg-en/products-services/ps-technology/ps-connectivity-services/ps-connectivity-services-time-services | 技术文档 |

---

## 附录：数据来源性质说明

| 来源 | 类型 | 可信度 | 说明 |
|------|------|--------|------|
| Nasdaq Co-Location页面 | 产品营销 | 中 | 官方宣传数据，"sub-50µs"为商业承诺而非实测报告 |
| Nasdaq Express Connect | 产品事实表 | 中 | 技术概述，无详细延迟分解 |
| Nasdaq价格表 | 官方定价 | 高 | 2016年版本，价格可能已变动 |
| T7技术白皮书 | 技术文档 | 高 | 详细的延迟路径分解、实测数据、硬件规格 |

---

全球主要交易所交易系统:

美国:
├── Nasdaq → INET (后继者)
├── NYSE → Pillar
└── CME → Globex

欧洲:
├── Deutsche Börse → T7  ← 就是这个
├── London Stock Exchange → Millennium
└── Euronext → Optiq

亚洲:
├── 东京证券交易所 → arrowhead
├── 上海证券交易所 → 新一代交易系统
└── 香港交易所 → Orion

---

*文档版本: 1.1 | 创建日期: 2026-01-28 | 最后修订: 2026-01-28*

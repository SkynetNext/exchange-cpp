# Exchange Core Performance Benchmark: C++ vs Java Comparison

## Performance Summary

### Key Performance Metrics

| Metric | C++ | Java | Winner |
|--------|-----|------|--------|
| **Max Stable TPS** | 9.4M TPS | 6M TPS | ✅ C++ (1.57x) |
| **P50 @ 1M TPS** | 0.49µs | 0.51µs | ✅ C++ (1.04x) |
| **P99 @ 1M TPS** | 0.72µs | 4.7µs | ✅ C++ (6.5x) |
| **P50 @ 4M TPS** | 0.79µs | 0.6µs | ✅ Java (1.32x) |
| **P99 @ 4M TPS** | 1.44µs | 8.0µs | ✅ C++ (5.6x) |
| **P50 @ 6M TPS** | 1.15µs | 1.37µs | ✅ C++ (1.19x) |
| **P99 @ 6M TPS** | 3.2µs | 11.5µs | ✅ C++ (3.6x) |
| **P50 @ 8M TPS** | 3.2µs | N/A | ✅ C++ |
| **P99 @ 8M TPS** | 12µs | N/A | ✅ C++ |

**Summary**: C++ shows dramatically better P99 latency (tail latency) across all TPS rates, with improvements of 3.6-6.5x. After optimizing `orderIdIndex_` from ART to `ankerl::unordered_dense::map` (2026-01-16) and `keys_` from `int16_t` to `uint8_t` (2026-01-22), C++ now achieves better P50 at 6M TPS and maintains stable performance up to 9.4M TPS. Maximum stable throughput improved from 9M to 9.4M TPS (+4.4%).

---

## Detailed Performance Data

### Performance Comparison by Rate

**C++ Implementation (v3 - after uint8_t optimization, 2026-01-22):**

| rate | 50.0% | 90.0% | 95.0% | 99.0% | 99.9% | 99.99% | worst |
|------|-------|-------|-------|-------|-------|--------|-------|
| 200K | 0.51µs | 0.63µs | 0.69µs | 0.86µs | 5.2µs | 8.6µs | 73µs |
| 300K | 0.50µs | 0.60µs | 0.66µs | 0.81µs | 5.4µs | 8.8µs | 108µs |
| 500K | 0.49µs | 0.58µs | 0.62µs | 0.77µs | 6.2µs | 15.2µs | 69µs |
| 1M | 0.49µs | 0.56µs | 0.60µs | 0.72µs | 6.3µs | 10µs | 27.5µs |
| 2M | 0.48µs | 0.55µs | 0.58µs | 0.71µs | 7.1µs | 9.8µs | 23.9µs |
| 3M | 0.50µs | 0.60µs | 0.66µs | 0.95µs | 7.8µs | 11.1µs | 26.4µs |
| 4M | 0.79µs | 1.01µs | 1.09µs | 1.44µs | 9.4µs | 45µs | 77µs |
| 5M | 0.97µs | 1.21µs | 1.31µs | 1.81µs | 9.9µs | 27µs | 43µs |
| 6M | 1.15µs | 1.50µs | 1.67µs | 3.2µs | 31µs | 68µs | 84µs |
| 7M | 1.89µs | 2.63µs | 2.95µs | 9.4µs | 97µs | 129µs | 137µs |
| 8M | 3.2µs | 4.4µs | 5.0µs | 12µs | 147µs | 167µs | 175µs |
| 9M | 6.6µs | 9.3µs | 11.3µs | 22.6µs | 181µs | 199µs | 207µs |
| 9.4M | 11.5µs | 18.9µs | 23.1µs | 95µs | 182µs | 192µs | 200µs |

**Java Implementation:**

| rate | 50.0% | 90.0% | 95.0% | 99.0% | 99.9% | 99.99% | worst |
|------|-------|-------|-------|-------|-------|--------|-------|
| 125K | 0.54µs | 0.69µs | 0.77µs | 1.9µs | 10.5µs | 40µs | 131µs |
| 250K | 0.53µs | 0.66µs | 0.74µs | 2.29µs | 9.3µs | 40µs | 127µs |
| 500K | 0.51µs | 0.63µs | 0.71µs | 3.6µs | 9.9µs | 42µs | 117µs |
| 1M | 0.51µs | 0.63µs | 0.72µs | 4.7µs | 9.3µs | 50µs | 137µs |
| 2M | 0.52µs | 0.71µs | 1.63µs | 5.8µs | 12.2µs | 50µs | 94µs |
| 3M | 0.59µs | 1.03µs | 4.0µs | 6.8µs | 12.8µs | 40µs | 72µs |
| 4M | 0.6µs | 3.5µs | 5.4µs | 8.0µs | 38µs | 137µs | 168µs |
| 5M | 0.68µs | 5.3µs | 6.7µs | 9.5µs | 47µs | 142µs | 161µs |
| 6M | 1.37µs | 6.9µs | 8.0µs | 11.5µs | 41µs | 67µs | 77µs |

**Note**: For 125K and 250K rates, data from 200K and 300K TPS tests are used respectively as closest approximations.

---

## Test Environment

**Date**: 2026-01-22 
**Platform**: Linux (Ubuntu)  
**CPU**: AMD EPYC 9Y24 96-Core Processor (16 cores, 8 cores/socket, 2 threads/core)  
**CPU Caches**: L1d: 256 KiB (8×), L1i: 256 KiB (8×), L2: 8 MiB (8×), L3: 32 MiB (1×)  
**Memory**: 61 GiB total, 48 GiB available  
**Storage**: 
- /dev/vda: 40 GiB (Virtual Disk, virtio-blk) - Root filesystem
- /dev/vdb: 500 GiB (Virtual Disk, virtio-blk) - Data/journaling storage (/data, ext4)
- **Backend**: KVM virtualized storage (actual physical storage type unknown from guest)
**Virtualization**: KVM  
**Build**: C++ (optimized native), Java (JVM with JIT, Java 8u192)  
**CPU Affinity**: Enabled
**Kernel Optimization**: `isolcpus=8-15 nohz_full=8-15 rcu_nocbs=8-15` (CPU 8-15 isolated for application)

---

## TestLatencyMargin Results

Latency test for single symbol (Margin mode) with progressive TPS increase to measure latency characteristics under different load conditions.

### Test Configuration

| Parameter | Value |
|-----------|-------|
| Symbol Type | `FUTURES_CONTRACT` |
| Symbols | 1 |
| Benchmark Commands | 3,000,000 |
| PreFill Commands | 1,000 |
| Users | 2,000 currency accounts (1,325 unique users) |
| Currencies | 2 (USD, EUR) |
| Warmup Cycles | 16 |
| Ring Buffer | 2,048 |
| Matching Engines | 1 |
| Risk Engines | 1 |
| Messages in Group Limit | 256 |

**Test Strategy**: Progressive TPS increase (200K → 300K → 400K → ...) until median latency exceeds 10ms (10,000,000 nanoseconds)

### C++ Implementation

| TPS | Throughput (MT/s) | 50% | 90% | 95% | 99% | 99.9% | 99.99% | Max |
|-----|-------------------|-----|-----|-----|-----|-------|--------|-----|
| 200K | 0.200 | 0.51µs | 0.63µs | 0.69µs | 0.86µs | 5.2µs | 8.6µs | 73µs |
| 300K | 0.300 | 0.50µs | 0.60µs | 0.66µs | 0.81µs | 5.4µs | 8.8µs | 108µs |
| 400K | 0.400 | 0.49µs | 0.58µs | 0.63µs | 0.78µs | 5.5µs | 8.9µs | 76µs |
| 500K | 0.500 | 0.49µs | 0.58µs | 0.62µs | 0.77µs | 6.2µs | 15.2µs | 69µs |
| 600K | 0.600 | 0.49µs | 0.57µs | 0.62µs | 0.75µs | 5.9µs | 9.6µs | 60µs |
| 700K | 0.700 | 0.48µs | 0.57µs | 0.60µs | 0.74µs | 6.1µs | 9.5µs | 53µs |
| 800K | 0.800 | 0.49µs | 0.57µs | 0.61µs | 0.74µs | 6.1µs | 9.5µs | 86µs |
| 900K | 0.900 | 0.49µs | 0.57µs | 0.61µs | 0.73µs | 6.2µs | 12.8µs | 74µs |
| 1.0M | 1.000 | 0.49µs | 0.56µs | 0.60µs | 0.72µs | 6.3µs | 10µs | 27.5µs |
| 1.1M | 1.100 | 0.49µs | 0.56µs | 0.59µs | 0.72µs | 6.8µs | 18.3µs | 86µs |
| 1.2M | 1.200 | 0.48µs | 0.55µs | 0.58µs | 0.71µs | 7.1µs | 24.5µs | 83µs |
| 1.3M | 1.300 | 0.48µs | 0.56µs | 0.59µs | 0.70µs | 7µs | 19µs | 81µs |
| 1.4M | 1.401 | 0.48µs | 0.56µs | 0.59µs | 0.71µs | 7µs | 19µs | 84µs |
| 1.5M | 1.502 | 0.48µs | 0.56µs | 0.59µs | 0.70µs | 6.8µs | 9.7µs | 22.2µs |
| 1.6M | 1.600 | 0.48µs | 0.55µs | 0.58µs | 0.70µs | 7µs | 11.2µs | 41µs |
| 1.7M | 1.701 | 0.48µs | 0.55µs | 0.58µs | 0.70µs | 6.8µs | 10.4µs | 23.7µs |
| 1.8M | 1.802 | 0.48µs | 0.55µs | 0.58µs | 0.70µs | 7µs | 12.6µs | 42µs |
| 1.9M | 1.901 | 0.47µs | 0.54µs | 0.57µs | 0.71µs | 7.2µs | 12.9µs | 64µs |
| 2.0M | 2.000 | 0.48µs | 0.55µs | 0.58µs | 0.71µs | 7.1µs | 9.8µs | 23.9µs |
| 2.1M | 2.101 | 0.48µs | 0.55µs | 0.59µs | 0.72µs | 7.5µs | 19.1µs | 64µs |
| 2.2M | 2.203 | 0.48µs | 0.56µs | 0.59µs | 0.73µs | 7.2µs | 10.1µs | 25.1µs |
| 2.3M | 2.304 | 0.48µs | 0.56µs | 0.59µs | 0.74µs | 7.3µs | 9.9µs | 22.5µs |
| 2.4M | 2.404 | 0.49µs | 0.57µs | 0.60µs | 0.76µs | 7.3µs | 15.5µs | 52µs |
| 2.5M | 2.500 | 0.49µs | 0.57µs | 0.60µs | 0.78µs | 7.6µs | 17.6µs | 50µs |
| 2.6M | 2.604 | 0.49µs | 0.57µs | 0.61µs | 0.79µs | 7.6µs | 10.2µs | 25µs |
| 2.7M | 2.703 | 0.49µs | 0.57µs | 0.61µs | 0.82µs | 8.1µs | 27.8µs | 78µs |
| 2.8M | 2.801 | 0.49µs | 0.58µs | 0.63µs | 0.86µs | 8.3µs | 33µs | 71µs |
| 2.9M | 2.907 | 0.50µs | 0.59µs | 0.64µs | 0.91µs | 8µs | 29.4µs | 66µs |
| 3.0M | 3.003 | 0.50µs | 0.60µs | 0.66µs | 0.95µs | 7.8µs | 11.1µs | 26.4µs |
| 3.1M | 3.106 | 0.50µs | 0.62µs | 0.70µs | 1.00µs | 8µs | 12.1µs | 25.1µs |
| 3.2M | 3.205 | 0.51µs | 0.66µs | 0.74µs | 1.04µs | 8.1µs | 14.1µs | 38µs |
| 3.3M | 3.300 | 0.53µs | 0.72µs | 0.81µs | 1.11µs | 8.5µs | 43µs | 70µs |
| 3.4M | 3.401 | 0.56µs | 0.77µs | 0.89µs | 1.13µs | 8.1µs | 16.6µs | 32µs |
| 3.5M | 3.509 | 0.63µs | 0.88µs | 0.96µs | 1.18µs | 7.9µs | 12µs | 27.4µs |
| 3.6M | 3.610 | 0.69µs | 0.94µs | 1.01µs | 1.28µs | 8.2µs | 13µs | 32µs |
| 3.7M | 3.704 | 0.72µs | 0.96µs | 1.03µs | 1.33µs | 8.6µs | 19.6µs | 36µs |
| 3.8M | 3.802 | 0.74µs | 0.98µs | 1.04µs | 1.36µs | 8.8µs | 14.8µs | 25.9µs |
| 3.9M | 3.906 | 0.77µs | 1.00µs | 1.06µs | 1.40µs | 9µs | 48µs | 72µs |
| 4.0M | 4.000 | 0.79µs | 1.01µs | 1.09µs | 1.44µs | 9.4µs | 45µs | 77µs |
| 4.1M | 4.115 | 0.82µs | 1.04µs | 1.13µs | 1.48µs | 9.2µs | 45µs | 77µs |
| 4.2M | 4.202 | 0.85µs | 1.06µs | 1.17µs | 1.54µs | 10.2µs | 18.7µs | 32µs |
| 4.3M | 4.310 | 0.87µs | 1.10µs | 1.20µs | 1.57µs | 9.4µs | 36µs | 60µs |
| 4.4M | 4.405 | 0.90µs | 1.14µs | 1.23µs | 1.59µs | 9.4µs | 22.2µs | 37µs |
| 4.5M | 4.505 | 0.91µs | 1.16µs | 1.25µs | 1.63µs | 9.6µs | 27.3µs | 51µs |
| 4.6M | 4.608 | 0.93µs | 1.18µs | 1.26µs | 1.67µs | 9.7µs | 57µs | 91µs |
| 4.7M | 4.717 | 0.94µs | 1.20µs | 1.28µs | 1.71µs | 9.3µs | 33µs | 71µs |
| 4.8M | 4.808 | 0.95µs | 1.20µs | 1.28µs | 1.73µs | 9.6µs | 26.2µs | 44µs |
| 4.9M | 4.902 | 0.96µs | 1.21µs | 1.30µs | 1.78µs | 9.9µs | 34µs | 71µs |
| 5.0M | 5.000 | 0.97µs | 1.21µs | 1.31µs | 1.81µs | 9.9µs | 27µs | 43µs |
| 5.1M | 5.102 | 0.98µs | 1.24µs | 1.35µs | 1.96µs | 13.6µs | 43µs | 67µs |
| 5.2M | 5.208 | 0.99µs | 1.25µs | 1.37µs | 1.91µs | 10.3µs | 26µs | 45µs |
| 5.3M | 5.319 | 1.02µs | 1.29µs | 1.40µs | 1.98µs | 10.5µs | 23.2µs | 40µs |
| 5.4M | 5.405 | 1.02µs | 1.30µs | 1.41µs | 2.02µs | 11µs | 47µs | 58µs |
| 5.5M | 5.525 | 1.03µs | 1.32µs | 1.44µs | 2.16µs | 12.1µs | 26.5µs | 40µs |
| 5.6M | 5.618 | 1.06µs | 1.35µs | 1.48µs | 2.21µs | 10.8µs | 26µs | 42µs |
| 5.7M | 5.714 | 1.08µs | 1.38µs | 1.52µs | 2.27µs | 10.8µs | 23.2µs | 38µs |
| 5.8M | 5.814 | 1.10µs | 1.41µs | 1.56µs | 2.59µs | 27.3µs | 61µs | 74µs |
| 5.9M | 5.917 | 1.14µs | 1.48µs | 1.64µs | 2.82µs | 23.9µs | 60µs | 73µs |
| 6.0M | 6.024 | 1.15µs | 1.50µs | 1.67µs | 3.2µs | 31µs | 68µs | 84µs |
| 6.1M | 6.135 | 1.17µs | 1.55µs | 1.74µs | 3.4µs | 40µs | 76µs | 93µs |
| 6.2M | 6.211 | 1.20µs | 1.59µs | 1.78µs | 3.2µs | 40µs | 80µs | 94µs |
| 6.3M | 6.329 | 1.23µs | 1.64µs | 1.84µs | 3.2µs | 29.9µs | 63µs | 78µs |
| 6.4M | 6.410 | 1.26µs | 1.70µs | 1.91µs | 4.3µs | 46µs | 73µs | 84µs |
| 6.5M | 6.536 | 1.33µs | 1.80µs | 2.03µs | 4.7µs | 50µs | 93µs | 107µs |
| 6.6M | 6.623 | 1.38µs | 1.88µs | 2.11µs | 4.6µs | 53µs | 85µs | 98µs |
| 6.7M | 6.711 | 1.42µs | 1.96µs | 2.22µs | 6.2µs | 77µs | 111µs | 121µs |
| 6.8M | 6.803 | 1.46µs | 2.01µs | 2.27µs | 6.0µs | 105µs | 142µs | 150µs |
| 6.9M | 6.944 | 1.62µs | 2.25µs | 2.53µs | 5.7µs | 70µs | 100µs | 109µs |
| 7.0M | 7.042 | 1.89µs | 2.63µs | 2.95µs | 9.4µs | 97µs | 129µs | 137µs |
| 7.1M | 7.143 | 1.89µs | 2.60µs | 2.93µs | 9.4µs | 97µs | 124µs | 131µs |
| 7.2M | 7.246 | 1.89µs | 2.69µs | 3.00µs | 9.9µs | 102µs | 125µs | 132µs |
| 7.3M | 7.353 | 2.01µs | 2.75µs | 3.10µs | 8.4µs | 91µs | 116µs | 124µs |
| 7.4M | 7.407 | 2.10µs | 2.87µs | 3.20µs | 7.6µs | 61µs | 85µs | 94µs |
| 7.5M | 7.519 | 2.35µs | 3.20µs | 3.60µs | 9.8µs | 91µs | 113µs | 119µs |
| 7.6M | 7.634 | 2.47µs | 3.40µs | 3.80µs | 9.6µs | 114µs | 132µs | 139µs |
| 7.7M | 7.752 | 2.88µs | 3.90µs | 4.40µs | 9.9µs | 135µs | 155µs | 162µs |
| 7.8M | 7.812 | 2.78µs | 3.80µs | 4.30µs | 11.2µs | 94µs | 112µs | 117µs |
| 7.9M | 7.937 | 3.10µs | 4.20µs | 4.80µs | 10.8µs | 132µs | 150µs | 157µs |
| 8.0M | 8.000 | 3.20µs | 4.40µs | 5.00µs | 12µs | 147µs | 167µs | 175µs |
| 8.1M | 8.130 | 3.60µs | 5.00µs | 5.60µs | 12µs | 147µs | 167µs | 173µs |
| 8.2M | 8.264 | 3.80µs | 5.20µs | 5.90µs | 12.4µs | 152µs | 172µs | 176µs |
| 8.3M | 8.333 | 3.90µs | 5.30µs | 6.10µs | 16.7µs | 226µs | 261µs | 271µs |
| 8.4M | 8.403 | 4.20µs | 5.70µs | 6.50µs | 17.1µs | 225µs | 264µs | 269µs |
| 8.5M | 8.547 | 4.60µs | 6.30µs | 7.40µs | 52µs | 232µs | 264µs | 270µs |
| 8.6M | 8.621 | 5.00µs | 6.80µs | 7.90µs | 17.9µs | 168µs | 185µs | 190µs |
| 8.7M | 8.772 | 5.50µs | 7.60µs | 9.00µs | 91µs | 242µs | 259µs | 265µs |
| 8.8M | 8.850 | 6.30µs | 8.90µs | 11.60µs | 49µs | 164µs | 179µs | 189µs |
| 8.9M | 8.929 | 6.40µs | 8.70µs | 10.40µs | 18.9µs | 172µs | 190µs | 198µs |
| 9.0M | 9.009 | 6.60µs | 9.30µs | 11.30µs | 22.6µs | 181µs | 199µs | 207µs |
| 9.1M | 9.174 | 7.30µs | 10.70µs | 13.70µs | 57µs | 156µs | 171µs | 179µs |
| 9.2M | 9.259 | 8.90µs | 13.80µs | 16.70µs | 42µs | 188µs | 202µs | 209µs |
| 9.3M | 9.346 | 9.10µs | 14.10µs | 17.10µs | 46µs | 196µs | 209µs | 217µs |
| 9.4M | 9.434 | 11.5µs | 18.9µs | 23.1µs | 95µs | 182µs | 192µs | 200µs |
| 9.5M | 9.524 | 14µs | 33µs | 156µs | 432µs | 527µs | 537µs | 543µs |
| 9.6M | 9.615 | 16µs | 25.6µs | 29.9µs | 147µs | 228µs | 239µs | 242µs |
| 9.7M | 9.709 | 18.2µs | 33µs | 42µs | 163µs | 234µs | 240µs | 245µs |
| 9.8M | 9.804 | 26.1µs | 53µs | 68µs | 224µs | 254µs | 259µs | 262µs |
| 9.9M | 9.901 | 39µs | 110µs | 145µs | 239µs | 255µs | 259µs | 262µs |
| 9.97M | 9.967 | 103µs | 262µs | 319µs | 366µs | 378µs | 382µs | 384µs |
| 10.0M | 10.033 | 305µs | 831µs | 1.19ms | 1.34ms | 1.36ms | 1.36ms | 1.36ms |
| 10.0M | 10.000 | 2.46ms | 4.6ms | 5.1ms | 5.3ms | 5.4ms | 5.4ms | 5.4ms |
| 10.1M | 10.067 | 3.4ms | 6.2ms | 6.7ms | 7.1ms | 7.1ms | 7.1ms | 7.2ms |
| 9.97M | 9.967 | 6.3ms | 11.1ms | 11.9ms | 12.5ms | 12.6ms | 12.6ms | 12.6ms |
| 10.1M | 10.101 | 6ms | 11ms | 11.8ms | 12.4ms | 12.5ms | 12.5ms | 12.5ms |
| 10.0M | 10.033 | 8.4ms | 15.3ms | 16.5ms | 17.3ms | 17.5ms | 17.5ms | 17.5ms |
| 10.0M | 10.033 | 9.7ms | 17.8ms | 19ms | 19.9ms | 20.1ms | 20.1ms | 20.1ms |
| 10.0M | 10.000 | 11.2ms | 20.8ms | 22.3ms | 23.3ms | 23.5ms | 23.5ms | 23.5ms |

### Java Implementation

| TPS | Throughput (MT/s) | 50% | 90% | 95% | 99% | 99.9% | 99.99% | Max |
|-----|-------------------|-----|-----|-----|-----|-------|--------|-----|
| 200K | 0.200 | 0.54µs | 0.69µs | 0.77µs | 1.9µs | 10.5µs | 40µs | 131µs |
| 300K | 0.300 | 0.53µs | 0.66µs | 0.74µs | 2.29µs | 9.3µs | 40µs | 127µs |
| 400K | 0.400 | 0.52µs | 0.64µs | 0.72µs | 3.0µs | 8.9µs | 38µs | 91µs |
| 500K | 0.500 | 0.51µs | 0.63µs | 0.71µs | 3.6µs | 9.9µs | 42µs | 117µs |
| 600K | 0.600 | 0.51µs | 0.63µs | 0.71µs | 3.9µs | 8.7µs | 38µs | 86µs |
| 700K | 0.700 | 0.51µs | 0.63µs | 0.7µs | 4.2µs | 9.9µs | 47µs | 102µs |
| 800K | 0.800 | 0.51µs | 0.63µs | 0.7µs | 4.3µs | 8.4µs | 33µs | 94µs |
| 900K | 0.900 | 0.51µs | 0.64µs | 0.72µs | 4.8µs | 9.3µs | 46µs | 100µs |
| 1.0M | 1.000 | 0.51µs | 0.63µs | 0.72µs | 4.7µs | 9.3µs | 50µs | 137µs |
| 1.1M | 1.100 | 0.51µs | 0.63µs | 0.72µs | 4.8µs | 9.5µs | 57µs | 141µs |
| 1.2M | 1.200 | 0.51µs | 0.63µs | 0.73µs | 5.0µs | 11.3µs | 53µs | 101µs |
| 1.3M | 1.300 | 0.51µs | 0.63µs | 0.74µs | 5.0µs | 9.7µs | 40µs | 72µs |
| 1.4M | 1.401 | 0.51µs | 0.64µs | 0.76µs | 5.1µs | 10.0µs | 38µs | 62µs |
| 1.5M | 1.502 | 0.51µs | 0.64µs | 0.8µs | 5.2µs | 10.9µs | 37µs | 60µs |
| 1.6M | 1.600 | 0.51µs | 0.64µs | 0.87µs | 5.4µs | 17.8µs | 56µs | 97µs |
| 1.7M | 1.701 | 0.51µs | 0.65µs | 0.93µs | 5.4µs | 10.4µs | 34µs | 63µs |
| 1.8M | 1.802 | 0.51µs | 0.66µs | 1.06µs | 5.5µs | 10.6µs | 46µs | 102µs |
| 1.9M | 1.901 | 0.51µs | 0.68µs | 1.33µs | 5.6µs | 13.7µs | 54µs | 87µs |
| 2.0M | 2.000 | 0.52µs | 0.71µs | 1.63µs | 5.8µs | 12.2µs | 50µs | 94µs |
| 2.1M | 2.101 | 0.52µs | 0.71µs | 1.89µs | 5.8µs | 12.2µs | 39µs | 71µs |
| 2.2M | 2.203 | 0.52µs | 0.71µs | 2.24µs | 6.0µs | 15.2µs | 62µs | 127µs |
| 2.3M | 2.304 | 0.53µs | 0.72µs | 2.46µs | 6.0µs | 15.5µs | 56µs | 101µs |
| 2.4M | 2.404 | 0.55µs | 0.74µs | 2.8µs | 6.3µs | 14.0µs | 50µs | 89µs |
| 2.5M | 2.500 | 0.55µs | 0.75µs | 2.96µs | 6.3µs | 15.6µs | 49µs | 91µs |
| 2.6M | 2.604 | 0.58µs | 0.77µs | 3.2µs | 6.4µs | 12.8µs | 44µs | 80µs |
| 2.7M | 2.703 | 0.58µs | 0.79µs | 3.4µs | 6.5µs | 15.9µs | 52µs | 90µs |
| 2.8M | 2.801 | 0.58µs | 0.82µs | 3.6µs | 6.6µs | 15.4µs | 46µs | 78µs |
| 2.9M | 2.907 | 0.59µs | 0.92µs | 3.8µs | 6.7µs | 14.5µs | 47µs | 100µs |
| 3.0M | 3.003 | 0.59µs | 1.03µs | 4.0µs | 6.8µs | 12.8µs | 40µs | 72µs |
| 3.1M | 3.106 | 0.59µs | 1.19µs | 4.2µs | 6.9µs | 12.8µs | 36µs | 56µs |
| 3.2M | 3.205 | 0.59µs | 1.39µs | 4.3µs | 7.0µs | 13.5µs | 39µs | 62µs |
| 3.3M | 3.300 | 0.59µs | 1.65µs | 4.5µs | 7.3µs | 27.6µs | 69µs | 85µs |
| 3.4M | 3.401 | 0.59µs | 1.86µs | 4.6µs | 7.2µs | 13.4µs | 52µs | 112µs |
| 3.5M | 3.509 | 0.59µs | 2.19µs | 4.8µs | 7.4µs | 14.4µs | 46µs | 79µs |
| 3.6M | 3.610 | 0.59µs | 2.46µs | 4.9µs | 7.5µs | 16.8µs | 55µs | 78µs |
| 3.7M | 3.704 | 0.59µs | 2.72µs | 5.1µs | 7.6µs | 18.7µs | 70µs | 120µs |
| 3.8M | 3.802 | 0.59µs | 2.94µs | 5.2µs | 7.7µs | 21.4µs | 137µs | 167µs |
| 3.9M | 3.906 | 0.59µs | 3.3µs | 5.3µs | 7.9µs | 27.5µs | 75µs | 101µs |
| 4.0M | 4.000 | 0.6µs | 3.5µs | 5.4µs | 8.0µs | 38µs | 137µs | 168µs |
| 4.1M | 4.115 | 0.6µs | 3.8µs | 5.6µs | 8.2µs | 22.0µs | 79µs | 120µs |
| 4.2M | 4.202 | 0.61µs | 4.0µs | 5.8µs | 8.4µs | 21.1µs | 50µs | 71µs |
| 4.3M | 4.310 | 0.62µs | 4.2µs | 5.9µs | 8.5µs | 27.6µs | 73µs | 105µs |
| 4.4M | 4.405 | 0.64µs | 4.4µs | 6.0µs | 8.6µs | 22.5µs | 56µs | 72µs |
| 4.5M | 4.505 | 0.64µs | 4.5µs | 6.1µs | 8.5µs | 22.3µs | 77µs | 93µs |
| 4.6M | 4.608 | 0.65µs | 4.7µs | 6.2µs | 8.7µs | 20.9µs | 60µs | 102µs |
| 4.7M | 4.717 | 0.66µs | 4.9µs | 6.4µs | 9.0µs | 42µs | 135µs | 158µs |
| 4.8M | 4.808 | 0.66µs | 5.0µs | 6.5µs | 9.0µs | 32µs | 96µs | 123µs |
| 4.9M | 4.902 | 0.67µs | 5.2µs | 6.6µs | 9.1µs | 23.7µs | 60µs | 81µs |
| 5.0M | 5.000 | 0.68µs | 5.3µs | 6.7µs | 9.5µs | 47µs | 142µs | 161µs |
| 5.1M | 5.102 | 0.7µs | 5.5µs | 6.9µs | 9.6µs | 51µs | 145µs | 167µs |
| 5.2M | 5.208 | 0.75µs | 5.7µs | 7.0µs | 9.5µs | 25.6µs | 78µs | 113µs |
| 5.3M | 5.319 | 0.76µs | 5.8µs | 7.1µs | 9.9µs | 49µs | 100µs | 128µs |
| 5.4M | 5.405 | 0.8µs | 5.9µs | 7.1µs | 9.5µs | 17.3µs | 34µs | 48µs |
| 5.5M | 5.525 | 0.83µs | 6.1µs | 7.3µs | 9.7µs | 18.7µs | 40µs | 71µs |
| 5.6M | 5.618 | 0.89µs | 6.2µs | 7.5µs | 10.0µs | 25.1µs | 52µs | 73µs |
| 5.7M | 5.714 | 1.0µs | 6.6µs | 7.9µs | 15.0µs | 101µs | 137µs | 154µs |
| 5.8M | 5.814 | 1.03µs | 6.6µs | 7.7µs | 11.0µs | 36µs | 55µs | 68µs |
| 5.9M | 5.917 | 1.17µs | 6.7µs | 7.9µs | 11.1µs | 77µs | 152µs | 167µs |
| 6.0M | 6.024 | 1.37µs | 6.9µs | 8.0µs | 11.5µs | 41µs | 67µs | 77µs |
| 6.1M | 6.135 | 1.54µs | 7.0µs | 8.2µs | 11.8µs | 39µs | 82µs | 100µs |
| 6.2M | 6.211 | 1.77µs | 7.2µs | 8.3µs | 12.7µs | 47µs | 64µs | 75µs |
| 6.3M | 6.329 | 2.21µs | 7.4µs | 8.6µs | 15.8µs | 67µs | 79µs | 91µs |
| 6.4M | 6.410 | 2.51µs | 7.5µs | 8.6µs | 12.3µs | 33µs | 58µs | 70µs |
| 6.5M | 6.536 | 2.93µs | 7.7µs | 8.8µs | 13.5µs | 37µs | 72µs | 93µs |
| 6.6M | 6.623 | 3.5µs | 8.2µs | 9.7µs | 25.6µs | 62µs | 78µs | 92µs |
| 6.7M | 6.711 | 4.2µs | 31µs | 205µs | 266µs | 301µs | 307µs | 313µs |
| 6.7M | 6.696 | **3.1ms** | 6.4ms | 7.3ms | 7.6ms | 7.7ms | 7.7ms | 7.7ms |
| 6.7M | 6.711 | **6.5ms** | 13.4ms | 14.9ms | 15.5ms | 15.6ms | 15.7ms | 15.7ms |
| 6.7M | 6.711 | **8.9ms** | 18.1ms | 19.8ms | 20.6ms | 20.8ms | 20.8ms | 20.8ms |
| 6.6M | 6.637 | **16.4ms** | 28.6ms | 31ms | 32ms | 32ms | 32ms | 32ms |


**Version**: 2.0 | **Date**: 2026-01-22 | **Tests**: `TestThroughputExchange`, `TestThroughputPeak`, `TestLatencyMargin`, `TestLatencyExchangeJournaling`, `SharedPool Queue Comparison`

**Latest Updates (2026-01-22)**:
- **ART Tree Optimization**: Changed `keys_` type from `int16_t` to `uint8_t` in Node4/Node16/Node48/Node256
- **Performance Improvement**: 
  - P50/P99 latency improved by 4-67% at 4-9M TPS
  - Worst-case latency reduced by 59-65% at 4-5M TPS
  - Max stable throughput improved from 9M to 9.4M TPS (+4.4%)
- **Previous Updates (2026-01-16)**:
  - Changed `orderIdIndex_` from `LongAdaptiveRadixTreeMap` to `ankerl::unordered_dense::map`
  - Max stable throughput improved from 8M to 9M TPS
- **Configuration**: Group=256, maxGroupDurationNs=10µs (default)
